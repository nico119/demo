<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.Mapper.TestMapper">

    <select id="checkUserInfo" parameterType="com.example.demo.Dto.UserDTO" resultType="com.example.demo.Dto.UserDTO">
        SELECT * FROM user
        WHERE name=(#{name}) and password=(#{password})
    </select>

    <select id="checkUser" parameterType="com.example.demo.Dto.UserDTO" resultType="int">
        SELECT COUNT(*) FROM user
        WHERE name=(#{name}) and password=(#{password})
    </select>

    <insert id="insertUser" parameterType="com.example.demo.Dto.UserDTO">
        INSERT INTO user (name,password) VALUES (#{name}, #{password})
    </insert>

    <insert id="insertContent" parameterType="com.example.demo.Dto.PostDTO">
        INSERT INTO post (title, content,delete_password, writer,user_id) VALUES (#{title},#{content},#{delete_password},#{writer},#{user_id})
    </insert>

    <select id="getPost" resultType="com.example.demo.Dto.PostDTO">
        SELECT
            id, title,content, delete_password,date, writer,user_id
        FROM
            post
        WHERE deleteYn ='N'
     </select>

    <select id="getPostCnt" resultType="int">
		SELECT
		    count(*) as listCnt
		FROM
			post
	</select>

    <select id="viewPostDetail" parameterType="com.example.demo.Dto.PostDTO" resultType="com.example.demo.Dto.PostDTO">
        SELECT
            id ,title, content, delete_password,writer,user_id,deleteYn
        FROM
            post
        WHERE
            id = (#{id})
    </select>

    <select id="checkWriter" parameterType="com.example.demo.Dto.PostDTO" resultType="com.example.demo.Dto.PostDTO">
        SELECT * FROM post WHERE name=(#{name}) and password=(#{password})
    </select>

    <update id="updatePost" parameterType="com.example.demo.Dto.PostDTO">
        UPDATE post SET title = (#{title}), content = (#{content}) WHERE id=(#{id})
    </update>

    <update id="deletePost" parameterType="int">
        UPDATE post SET deleteYn = 'Y' WHERE id=(#{id})
    </update>

    <select id="getPostById" parameterType="int" resultType="com.example.demo.Dto.PostDTO">
        SELECT id ,title, content, delete_password,writer,user_id,deleteYn FROM post  WHERE id = (#{id})
    </select>

    <select id="searchByKeyword" parameterType="String" resultType="com.example.demo.Dto.PostDTO">
        SELECT * FROM post WHERE deleteYn ='N' or content LIKE CONCAT('%',#{keyword},'%') or title LIKE CONCAT('%',#{keyword},'%')
    </select>
</mapper>